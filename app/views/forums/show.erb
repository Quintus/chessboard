<% if env["warden"].authenticated? %>
  <p class="top-right-nav"><%= link_to I18n.t("forums.new_topic"), url(:topics, :new) + "?" + "forum=#{@forum.id}", :class => "button-normal" %></p>
<% end %>
<h1><%= @forum.name %></h1>

<table class="topicslist">
  <thead>
    <tr>
      <th class="list-icon imgcell"></th>
      <th class="list-topic">Topic</th>
      <th class="list-replies numbercell">Replies</th>
      <th class="list-views numbercell">Views</th>
      <th class="forumlastpost"><%= I18n.t("forums.lastpost") %></th>
    </tr>
  </thead>
  <tbody>
    <%= partial "topics/forum_topic", :collection => @topics[:announcements] %>
    <%= partial "topics/forum_topic", :collection => @topics[:stickies] %>
    <%= partial "topics/forum_topic", :collection => @topics[:normal] %>
  </tbody>
</table>

<%# Page navigation %>
<% if @total_pages > 1 %>
  <ul class="forum-pages">
  <% if @current_page > 1 %>
    <li><%= link_to I18n.t("topics.prev_page"), url(:forums, :show, @forum.id) + "?page=#{@current_page - 1}" %></li>
  <% end %>

  <% if @total_pages <= 5 %>
    <% 1.upto(@total_pages) do |i| %>
      <li><%= link_to i, url(:forums, :show, @forum.id) + "?page=#{i}" %></li>
    <% end %>
  <% elsif @total_pages > 5 %>
    <% 1.upto(4) do |i| %>
      <li><%= link_to i, url(:forums, :show, @forum.id) + "?page=#{i}" %></li>
    <% end %>
    <li>â€¦</li>
    <li><%= link_to @total_pages, url(:forums, :show, @forum.id) + "?page=#{@total_pages}" %></li>
  <% end %>

  <% if @current_page < @total_pages %>
    <li><%= link_to I18n.t("topics.next_page"), url(:forums, :show, @forum.id) + "?page=#{@current_page + 1}" %></li>
  <% end %>

  </ul>
<% end %>
